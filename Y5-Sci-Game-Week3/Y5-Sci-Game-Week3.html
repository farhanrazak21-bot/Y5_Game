<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Y5 Science — Pollination Interactive</title>
<style>
  :root{
    --bg:#0f172a; --panel:#0b1220; --card:#111827; --muted:#9aa4b2; --ok:#22c55e; --warn:#f59e0b; --err:#ef4444; --blue:#60a5fa;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;background:var(--bg);color:#e5e7eb}
  header{position:sticky;top:0;background:var(--panel);border-bottom:1px solid #1f2937;padding:16px;z-index:10}
  h1{margin:0;font-size:20px}
  .sub{color:var(--muted);font-size:13px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
  .tab{background:var(--panel);border:1px solid #243042;border-radius:10px;color:#e5e7eb;padding:10px 12px;cursor:pointer}
  .tab.active{border-color:var(--ok);box-shadow:0 0 0 2px #14532d inset}
  .wrap{max-width:1180px;margin:16px auto;padding:0 16px;display:grid;gap:16px}
  @media(min-width:1100px){.wrap{grid-template-columns:1.45fr .55fr}}
  .card{background:var(--card);border:1px solid #1f2937;border-radius:16px;padding:16px}
  .panel{background:var(--panel);border:1px solid #253042;border-radius:12px;padding:10px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .result{margin-top:10px;padding:10px;border-radius:10px;background:var(--panel);border:1px solid #1f2937}
  .muted{color:var(--muted)} .ok{color:var(--ok)} .err{color:var(--err)}
  button{background:var(--panel);border:1px solid #253042;border-radius:10px;color:#e5e7eb;padding:10px 12px;cursor:pointer}
  button.primary{background:linear-gradient(135deg,#16a34a,#22c55e);border:none;color:#06210d}
  button.warn{background:#1f1300;border:1px solid #6b4e00;color:#ffd166}
  input,select,textarea{background:var(--panel);border:1px solid #253042;border-radius:10px;color:#e5e7eb;padding:10px}
  .stage{min-height:360px;display:flex;align-items:center;justify-content:center;background:#0b1220;border:1px solid #253042;border-radius:14px;padding:12px}
  .grid{display:grid;gap:10px}
  .grid-2{grid-template-columns:repeat(2,1fr)}
  .grid-3{grid-template-columns:repeat(3,1fr)}
  .tile{background:#0f1a2a;border:1px solid #263246;border-radius:12px;padding:12px;text-align:center;cursor:grab;user-select:none}
  .tile[aria-grabbed="true"]{outline:3px solid #22c55e}
  .drop{min-height:92px;border:2px dashed #334155;border-radius:12px;padding:8px;display:flex;gap:8px;flex-wrap:wrap}
  .chip{display:inline-flex;align-items:center;justify-content:center;padding:8px 12px;border:1px solid #2a3646;border-radius:999px;background:#0b1220;margin:6px;cursor:grab}
  .badge{font-size:12px;padding:2px 6px;border:1px solid #2a3646;border-radius:999px}
  .tiny{font-size:12px;color:#9aa4b2}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  .big{font-size:18px}
  .flex{display:flex;gap:8px;align-items:center}
  .badge-pill{display:inline-block;background:#1f2937;border-radius:999px;padding:4px 10px;border:1px solid #2a3646}
  .center{text-align:center}
</style>
</head>
<body>
  <header>
    <h1>Y5 Science — Pollination Interactive</h1>
    <div class="sub">Agents • Adaptations • Importance • Qur'an (An‑Nahl) • Eco Balance</div>
    <div class="tabs">
      <button class="tab active" data-tab="lead">0) 🌼 Lead‑in</button>
      <button class="tab" data-tab="sequence">1) 🔁 Pollination Sequence</button>
      <button class="tab" data-tab="agents">2) 🐝 Agents → Roles</button>
      <button class="tab" data-tab="adapt">3) 🌷 Adaptations Classifier</button>
      <button class="tab" data-tab="sim">4) 🐝➡️🌸 Bee & Pollen Sim</button>
      <button class="tab" data-tab="quiz">5) 🧩 Quick Quiz</button>
    </div>
  </header>

  <div class="wrap">
    <section class="card" id="main">
      <h2 style="margin:0 0 8px">Activity Panel</h2>
      <div id="view"></div>
    </section>

    <aside class="card">
      <h3 style="margin:0 0 8px">Teacher Prompts & Values</h3>
      <div class="panel">
        <ul class="muted" style="margin-left:18px">
          <li>Begin with salam + short <b>dua</b>. Recall prior lesson on flowers.</li>
          <li>Ask: What is <b>pollination</b>? Name pollinators. Why is it important?</li>
          <li>Faith: Allah mentions bees in <b>Surah An‑Nahl</b>; they have a special role (amanah).</li>
          <li>Eco: Protect bees, reduce pesticides, plant native flowers → support food chains.</li>
          <li>Differentiation: Use <em>Less‑able Mode</em> where available; model first then release.</li>
        </ul>
      </div>
      <div class="panel">
        <div><span class="badge">Progress</span></div>
        <div class="result">Score: <b id="score">0</b> · Tries: <b id="tries">0</b> · Stars: <b id="stars">☆☆☆</b></div>
      </div>
    </aside>
  </div>

<script>
const $=(s,el=document)=>el.querySelector(s); const $$=(s,el=document)=>[...el.querySelectorAll(s)];
let SCORE=0, TRIES=0; function add(n){SCORE+=n; TRIES++; $('#score').textContent=SCORE; $('#tries').textContent=TRIES; $('#stars').textContent= SCORE>=36?'★★★':SCORE>=20?'★★☆':SCORE>=10?'★☆☆':'☆☆☆';}
$$('.tab').forEach(t=>t.addEventListener('click',()=>{ $$('.tab').forEach(x=>x.classList.remove('active')); t.classList.add('active'); const id=t.dataset.tab; ({lead:renderLead, sequence:renderSequence, agents:renderAgents, adapt:renderAdapt, sim:renderSim, quiz:renderQuiz}[id])(); }));

/****************** Lead‑in ******************/
function renderLead(){ const v=$('#view'); v.innerHTML=`
  <div class="stage"><div class="grid" style="gap:12px;max-width:780px">
    <div class="panel">
      <div class="badge">Prompt</div>
      <p>Look at the picture in your mind: 🐝 a bee covered in yellow dust visiting a 🌸 flower. What is happening? <b>Pollination</b> — moving pollen to help plants make seeds/fruits.</p>
      <p class="muted">Islamic link: Allah created bees with a special role (<em>An‑Nahl</em>). Caring for bees is part of our <b>amanah</b>.</p>
    </div>
    <div class="grid grid-3">
      <div class="tile" aria-label="flower">🌸 Flower</div>
      <div class="tile" aria-label="bee">🐝 Bee</div>
      <div class="tile" aria-label="wind">💨 Wind</div>
    </div>
    <div class="result tiny">Use the tabs above, left→right.</div>
  </div></div>`; }

/****************** 1) Pollination Sequence ******************/
function renderSequence(){ const v=$('#view'); v.innerHTML=`
  <div class="row"><button class="primary" id="reset">Reset</button> <button class="primary" id="check">Check</button> <button class="warn" id="easy">Less‑able Mode</button></div>
  <div class="panel" style="margin-top:8px">
    <div class="badge">Arrange in order (left→right)</div>
    <div id="pool" class="drop" aria-label="pool"></div>
    <div class="row" style="margin-top:8px"><div class="badge">Your Sequence</div></div>
    <div id="seq" class="drop" aria-label="sequence"></div>
  </div>
  <div class="result" id="out"></div>`;
  let easy=false;
  const steps=[
    {id:'s1',t:'1) 🌸 Flower has pollen on anther'},
    {id:'s2',t:'2) 🐝/💨 picks up & carries pollen'},
    {id:'s3',t:'3) 🌸 Pollen lands on stigma'},
    {id:'s4',t:'4) 🌱 Fertilisation → seed/fruit forms'}
  ];
  function tile(s){ const d=document.createElement('div'); d.className='tile'; d.textContent=s.t; d.id=s.id; d.draggable=true; d.addEventListener('dragstart',e=>{ d.setAttribute('aria-grabbed','true'); e.dataTransfer.setData('text/plain',d.id); }); d.addEventListener('dragend',()=>d.removeAttribute('aria-grabbed')); return d; }
  function hookDZ(el){ el.addEventListener('dragover',e=>{e.preventDefault(); el.style.outline='2px solid var(--ok)'}); el.addEventListener('dragleave',()=>el.style.outline='none'); el.addEventListener('drop',e=>{e.preventDefault(); el.style.outline='none'; const id=e.dataTransfer.getData('text/plain'); const chip=document.getElementById(id); if(chip) el.appendChild(chip); if(easy && el.id==='seq'){ // snap to order hint
      const kids=[...$('#seq').children]; kids.forEach((k,i)=>k.style.borderColor=(k.id==='s'+(i+1)?'#14532d':'#7f1d1d')); }
    }); }
  const pool=$('#pool'), seq=$('#seq'); hookDZ(pool); hookDZ(seq);
  function reset(){ pool.innerHTML=''; seq.innerHTML=''; [...steps].sort(()=>Math.random()-0.5).forEach(s=>pool.appendChild(tile(s))); $('#out').textContent=''; }
  reset();
  $('#reset').onclick=reset; $('#easy').onclick=()=>{ easy=!easy; $('#easy').textContent=easy?'Standard Mode':'Less‑able Mode'; reset(); };
  $('#check').onclick=()=>{ const ids=[...$('#seq').children].map(x=>x.id); const ok=(ids.join(',')==='s1,s2,s3,s4'); if(ok){ add(8); $('#out').innerHTML='<span class="ok">Excellent — that\'s the pollination → fertilisation sequence.</span>'; } else { add(0); $('#out').innerHTML='<span class="err">Not yet. Hint: anther → carrier → stigma → seed/fruit.</span>'; } };
}

/****************** 2) Agents → Roles ******************/
function renderAgents(){ const v=$('#view'); v.innerHTML=`
  <div class="row"><button class="primary" id="new">New Set</button> <button class="primary" id="check">Check</button> <button class="warn" id="easy">Less‑able Mode</button></div>
  <div class="panel" style="margin-top:8px">
    <div class="badge">Drag each <b>agent</b> to its <b>role</b></div>
    <div class="row" style="align-items:flex-start;gap:12px">
      <div style="flex:1"><div class="badge">Agents</div><div id="pool" class="drop"></div></div>
      <div style="flex:1"><div class="badge">🐝 Insect (bee/butterfly) role</div><div id="r_insect" class="drop"></div></div>
      <div style="flex:1"><div class="badge">💨 Wind role</div><div id="r_wind" class="drop"></div></div>
    </div>
  </div>
  <div class="result tiny">Islamic link: Bees are mentioned in Surah An‑Nahl — a sign of Allah\'s wisdom. Eco: protect pollinators.</div>
  <div class="result" id="out"></div>`;
  let easy=false;
  const bank=[
    {t:'Carry sticky pollen from flower to flower', to:'r_insect', icon:'🐝'},
    {t:'Move light pollen through the air', to:'r_wind', icon:'💨'},
    {t:'Visit bright, scented flowers for nectar', to:'r_insect', icon:'🌸'},
    {t:'Shake exposed stamens to release pollen', to:'r_wind', icon:'🌾'}
  ];
  function chip(o){ const d=document.createElement('div'); d.className='chip big'; d.textContent=o.icon+' '+o.t; d.id='a_'+Math.random().toString(36).slice(2,7); d.draggable=true; d.dataset.to=o.to; d.addEventListener('dragstart',e=>e.dataTransfer.setData('text/plain',d.id)); return d; }
  function hook(id){ const dz=$('#'+id); dz.addEventListener('dragover',e=>{e.preventDefault(); dz.style.outline='2px solid var(--ok)'}); dz.addEventListener('dragleave',()=>dz.style.outline='none'); dz.addEventListener('drop',e=>{e.preventDefault(); dz.style.outline='none'; const id=e.dataTransfer.getData('text/plain'); const el=document.getElementById(id); if(el){ dz.appendChild(el); if(easy){ dz.style.boxShadow='0 0 0 2px '+(el.dataset.to===dz.id?'#14532d':'#7f1d1d')+' inset'; }}}); }
  function draw(){ const pool=$('#pool'); pool.innerHTML=''; ['r_insect','r_wind'].forEach(id=>{ $('#'+id).innerHTML=''; $('#'+id).style.boxShadow='none';}); [...bank].sort(()=>Math.random()-0.5).forEach(o=>pool.appendChild(chip(o))); }
  ['pool','r_insect','r_wind'].forEach(hook); draw();
  $('#new').onclick=draw; $('#easy').onclick=()=>{ easy=!easy; $('#easy').textContent=easy?'Standard Mode':'Less‑able Mode'; draw(); };
  $('#check').onclick=()=>{ let ok=true; ['r_insect','r_wind'].forEach(id=>{ $$('#'+id+' .chip').forEach(c=>{ if(c.dataset.to!==id) ok=false; });}); if(ok){ add(8); $('#out').innerHTML='<span class="ok">Great matching! Insects carry sticky pollen; wind moves light pollen.</span>'; } else { add(0); $('#out').innerHTML='<span class="err">Some items don\'t match — try again.</span>'; } };
}

/****************** 3) Adaptations Classifier ******************/
function renderAdapt(){ const v=$('#view'); v.innerHTML=`
  <div class="row"><button class="primary" id="new">New Cards</button> <button class="primary" id="check">Check</button> <button class="warn" id="easy">Less‑able Mode</button></div>
  <div class="panel" style="margin-top:8px">
    <div class="badge">Sort features → wind vs insect pollinated</div>
    <div class="row" style="align-items:flex-start;gap:12px">
      <div style="flex:1"><div class="badge">Features</div><div id="pool" class="drop"></div></div>
      <div style="flex:1"><div class="badge">🐝 Insect‑pollinated</div><div id="b_insect" class="drop"></div></div>
      <div style="flex:1"><div class="badge">💨 Wind‑pollinated</div><div id="b_wind" class="drop"></div></div>
    </div>
  </div>
  <div class="result" id="out"></div>`;
  let easy=false;
  const bank=[
    {t:'Bright petals & sweet scent', to:'b_insect'},
    {t:'Nectar to attract visitors', to:'b_insect'},
    {t:'Sticky, spiky pollen grains', to:'b_insect'},
    {t:'Dull/greenish petals, no scent', to:'b_wind'},
    {t:'Very light, smooth pollen', to:'b_wind'},
    {t:'Exposed, dangling stamens', to:'b_wind'}
  ];
  function chip(o){ const d=document.createElement('div'); d.className='chip big'; d.textContent=o.t; d.id='f_'+Math.random().toString(36).slice(2,7); d.draggable=true; d.dataset.to=o.to; d.addEventListener('dragstart',e=>e.dataTransfer.setData('text/plain',d.id)); return d; }
  function hook(id){ const dz=$('#'+id); dz.addEventListener('dragover',e=>{e.preventDefault(); dz.style.outline='2px solid var(--ok)'}); dz.addEventListener('dragleave',()=>dz.style.outline='none'); dz.addEventListener('drop',e=>{e.preventDefault(); dz.style.outline='none'; const id=e.dataTransfer.getData('text/plain'); const el=document.getElementById(id); if(el){ dz.appendChild(el); if(easy){ dz.style.boxShadow='0 0 0 2px '+(el.dataset.to===dz.id?'#14532d':'#7f1d1d')+' inset'; }}}); }
  function draw(){ const pool=$('#pool'); pool.innerHTML=''; ['b_insect','b_wind'].forEach(id=>{ $('#'+id).innerHTML=''; $('#'+id).style.boxShadow='none';}); [...bank].sort(()=>Math.random()-0.5).forEach(o=>pool.appendChild(chip(o))); }
  ['pool','b_insect','b_wind'].forEach(hook); draw();
  $('#new').onclick=draw; $('#easy').onclick=()=>{ easy=!easy; $('#easy').textContent=easy?'Standard Mode':'Less‑able Mode'; draw(); };
  $('#check').onclick=()=>{ let ok=true; ['b_insect','b_wind'].forEach(id=>{ $$('#'+id+' .chip').forEach(c=>{ if(c.dataset.to!==id) ok=false; });}); if(ok){ add(8); $('#out').innerHTML='<span class="ok">Spot on! Different flowers have different designs for pollination.</span>'; } else { add(0); $('#out').innerHTML='<span class="err">Some features are in the wrong bin — recheck.</span>'; } };
}

/****************** 4) Bee & Pollen Simulation ******************/
function renderSim(){ const v=$('#view'); v.innerHTML=`
  <div class="row"><button class="primary" id="start">Start</button> <button class="warn" id="reset">Reset</button> <label>Speed <span id="spdVal" class="mono">1x</span></label><input id="spd" type="range" min="1" max="4" value="1" step="1" style="width:220px"></div>
  <div class="stage"><canvas id="cv" width="740" height="320" style="max-width:100%;background:#0b1220;border:1px solid #253042;border-radius:12px"></canvas></div>
  <div class="panel tiny">Watch: 🐝 flies from Flower A (anther) → Flower B (stigma). Yellow dots = pollen.</div>
  <div class="result" id="simOut"></div>`;
  const c=$('#cv'), ctx=c.getContext('2d'); let t=0, anim=null, speed=1;
  function drawScene(){ ctx.clearRect(0,0,c.width,c.height);
    // ground
    ctx.fillStyle="#0b1930"; ctx.fillRect(0,240,740,80);
    // Flower A (left)
    drawFlower(160,220,'#f97316'); // orange
    // Flower B (right)
    drawFlower(560,220,'#a78bfa'); // purple
    // labels
    ctx.fillStyle='#9aa4b2'; ctx.font='12px system-ui'; ctx.fillText('Flower A (anther)', 120, 245);
    ctx.fillText('Flower B (stigma)', 520, 245);
  }
  function drawFlower(x,y,color){ // stem
    ctx.fillStyle='#22c55e'; ctx.fillRect(x-6,y-60,12,60);
    // petals
    ctx.fillStyle=color; for(let i=0;i<6;i++){ ctx.beginPath(); ctx.ellipse(x+Math.cos(i*Math.PI/3)*24, y-80+Math.sin(i*Math.PI/3)*12, 18, 8, 0, 0, Math.PI*2); ctx.fill(); }
    // center
    ctx.fillStyle='#f59e0b'; ctx.beginPath(); ctx.arc(x,y-80,10,0,Math.PI*2); ctx.fill();
    // stigma highlight on flower B
    if(x>300){ ctx.strokeStyle='#fde68a'; ctx.beginPath(); ctx.arc(x,y-80,12,0,Math.PI*2); ctx.stroke(); }
  }
  function drawBee(px,py){ ctx.save(); ctx.translate(px,py); ctx.fillStyle='#eab308'; ctx.beginPath(); ctx.ellipse(0,0,18,10,0,0,Math.PI*2); ctx.fill(); ctx.fillStyle='#000'; ctx.fillRect(-10,-6,6,12); ctx.fillRect(4,-6,6,12); // stripes
    // wings
    ctx.globalAlpha=0.7; ctx.fillStyle='#93c5fd'; ctx.beginPath(); ctx.ellipse(-6,-14,10,6,0,0,Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.ellipse(8,-14,10,6,0,0,Math.PI*2); ctx.fill(); ctx.globalAlpha=1;
    // eye
    ctx.fillStyle='#000'; ctx.beginPath(); ctx.arc(12,-2,2,0,Math.PI*2); ctx.fill(); ctx.restore(); }
  function drawPollenTrail(frac){ // scatter dots along path
    const n=18; for(let i=0;i<n;i++){ const f=(i/n)*frac; const p=pathLerp(f); ctx.fillStyle='rgba(250,204,21,'+(0.2+0.8*f)+')'; ctx.beginPath(); ctx.arc(p.x+Math.sin(i*7)*2, p.y+Math.cos(i*5)*2, 3, 0, Math.PI*2); ctx.fill(); }
  }
  function pathLerp(f){ // path from left flower top to right flower top in an arc
    const ax=160, ay=140, bx=560, by=140; const cx=(ax+bx)/2, cy=40; // control for curve (quadratic)
    const x=(1-f)*(1-f)*ax + 2*(1-f)*f*cx + f*f*bx; const y=(1-f)*(1-f)*ay + 2*(1-f)*f*cy + f*f*by; return {x,y};
  }
  function frame(){ drawScene(); const frac=Math.min(1, t/240); const p=pathLerp(frac); drawPollenTrail(frac); drawBee(p.x,p.y); if(frac>=1){ // pollen lands — glow on stigma & success text
      ctx.fillStyle='rgba(250,204,21,0.25)'; ctx.beginPath(); ctx.arc(560,140,16,0,Math.PI*2); ctx.fill(); $('#simOut').innerHTML='<span class="ok">Pollen reached the stigma → Pollination! Next, fertilisation forms seeds/fruit.</span>';
    }
    t+=1*speed; anim=requestAnimationFrame(frame);
  }
  drawScene();
  $('#spd').oninput=(e)=>{ speed=parseInt(e.target.value,10); $('#spdVal').textContent=speed+'x'; };
  $('#start').onclick=()=>{ if(anim) cancelAnimationFrame(anim); t=0; anim=requestAnimationFrame(frame); add(2); };
  $('#reset').onclick=()=>{ if(anim) cancelAnimationFrame(anim); t=0; drawScene(); $('#simOut').textContent=''; };
}

/****************** 5) Quick Quiz ******************/
function renderQuiz(){ const v=$('#view'); v.innerHTML='';
  const ui=document.createElement('div'); ui.innerHTML=`
    <div class="row"><button class="primary" id="newQ">New 8‑Q Set</button> <button class="primary" id="checkQ">Check</button> <button class="warn" id="hint">Hints</button></div>
    <div id="qs" style="margin-top:8px"></div>
    <div id="out" class="result"></div>`; v.appendChild(ui);
  const bank=[
    {t:'Pollination helps plants make seeds and fruits.', a:'T'},
    {t:'Bees carry sticky pollen between flowers.', a:'T'},
    {t:'Wind‑pollinated flowers usually have bright petals and strong scent.', a:'F'},
    {t:'Insect‑pollinated flowers often have nectar to attract visitors.', a:'T'},
    {t:'If pollinators disappear, some food chains can be harmed.', a:'T'},
    {t:'Pollen lands on the anther during pollination.', a:'F'},
    {t:'Allah mentions the bee in Surah An‑Nahl, showing its special role.', a:'T'},
    {t:'Protecting bees is not important for humans.', a:'F'}
  ];
  let set=[]; function gen(){ set=[...bank].sort(()=>Math.random()-0.5).slice(0,8); draw(); $('#out').textContent=''; }
  function draw(){ const host=$('#qs'); host.innerHTML=''; set.forEach((q,i)=>{ host.innerHTML+=`<div class=panel style="margin-bottom:8px"><div><span class=badge>Q${i+1}</span> ${q.t}</div>
    <div class=row><label><input type=radio name=q${i} value=T> True</label> <label><input type=radio name=q${i} value=F> False</label></div></div>`; }); }
  gen();
  $('#newQ').onclick=gen; $('#hint').onclick=()=>$('#out').innerHTML='Hints: insect=bright/scent/nectar/sticky pollen; wind=dull/no scent/light pollen; stigma receives pollen.';
  $('#checkQ').onclick=()=>{ let ok=0; set.forEach((q,i)=>{ const pick=($$("input[name='q"+i+"']:checked")[0]||{}).value; if(pick===q.a) ok++;}); if(ok===set.length){ add(10); $('#out').innerHTML='<span class="ok">Super work — full marks!</span>'; } else { add(0); $('#out').innerHTML='<span class="err">Correct:</span> '+ok+' / '+set.length+' — Review agents, adaptations & sequence.'; }
  };
}

// boot
renderLead();
</script>
</body>
</html>
